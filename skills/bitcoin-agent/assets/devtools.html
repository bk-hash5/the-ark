<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Ark AI ‚Äî Developer Tools for Sats ‚ö°</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0a0a0f;--card:#12121a;--card-hover:#1a1a28;--border:#1e1e2e;--accent:#f7931a;--accent2:#ff6b00;--text:#e0e0e0;--dim:#888;--green:#00e676;--blue:#64b5f6;--purple:#bb86fc;--pink:#f48fb1;--radius:12px}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,monospace;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden}
a{color:var(--accent);text-decoration:none}
a:hover{text-decoration:underline}

/* Stars */
.stars{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0}
.stars canvas{width:100%;height:100%}

/* Header */
.header{position:relative;z-index:1;text-align:center;padding:60px 20px 40px}
.logo{font-size:2.4rem;font-weight:800;margin-bottom:8px}
.logo .alien{font-size:2.8rem}
.tagline{font-size:1.1rem;color:var(--dim);margin-bottom:24px;max-width:600px;margin-left:auto;margin-right:auto}
.hero-stat{display:inline-flex;gap:24px;flex-wrap:wrap;justify-content:center}
.hero-stat span{background:var(--card);border:1px solid var(--border);padding:8px 18px;border-radius:20px;font-size:.85rem;color:var(--dim)}
.hero-stat span b{color:var(--accent)}

/* Filter */
.filter-bar{position:relative;z-index:1;display:flex;justify-content:center;gap:8px;padding:16px 20px;flex-wrap:wrap}
.filter-btn{background:var(--card);border:1px solid var(--border);color:var(--dim);padding:8px 16px;border-radius:20px;cursor:pointer;font-size:.82rem;transition:.2s}
.filter-btn:hover,.filter-btn.active{background:var(--accent);color:#000;border-color:var(--accent);font-weight:600}

/* Grid */
.grid{position:relative;z-index:1;display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px;max-width:1200px;margin:20px auto;padding:0 20px 40px}

/* Card */
.card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;transition:.25s;cursor:pointer}
.card:hover{border-color:var(--accent);transform:translateY(-2px);box-shadow:0 8px 32px rgba(247,147,26,.08)}
.card-head{padding:18px 18px 14px;display:flex;justify-content:space-between;align-items:flex-start}
.card-title{font-size:.95rem;font-weight:600}
.card-price{font-size:.8rem;color:var(--accent);font-weight:700;white-space:nowrap;background:rgba(247,147,26,.1);padding:3px 10px;border-radius:10px}
.card-desc{padding:0 18px 16px;font-size:.8rem;color:var(--dim);line-height:1.4}
.card-category{padding:0 18px 14px;font-size:.7rem;text-transform:uppercase;letter-spacing:1px;color:var(--dim);opacity:.6}

/* Expanded */
.card-expand{max-height:0;overflow:hidden;transition:max-height .35s ease}
.card.open .card-expand{max-height:600px}
.card-inner{padding:0 18px 18px}
.card-inner textarea{width:100%;background:#0a0a12;border:1px solid var(--border);color:var(--text);border-radius:8px;padding:10px;font-family:monospace;font-size:.82rem;resize:vertical;min-height:80px;outline:none}
.card-inner textarea:focus{border-color:var(--accent)}
.card-inner .submit-btn{margin-top:10px;width:100%;padding:10px;background:linear-gradient(135deg,var(--accent),var(--accent2));color:#000;font-weight:700;border:none;border-radius:8px;cursor:pointer;font-size:.85rem;transition:.2s}
.card-inner .submit-btn:hover{opacity:.9;transform:scale(1.01)}
.card-inner .submit-btn:disabled{opacity:.5;cursor:wait}

/* Result */
.card-result{margin-top:12px;text-align:center;font-size:.82rem;color:var(--dim)}
.card-result img{max-width:200px;margin:8px auto;display:block;border-radius:8px}
.card-result pre{text-align:left;background:#0a0a12;padding:10px;border-radius:8px;overflow-x:auto;margin-top:8px;font-size:.78rem;max-height:200px;overflow-y:auto;white-space:pre-wrap;word-break:break-word}
.card-result .invoice-text{font-size:.7rem;word-break:break-all;color:var(--dim);margin-top:6px;cursor:pointer;padding:6px;background:#0a0a12;border-radius:6px}
.card-result .pay-status{color:var(--green);font-weight:600;margin-top:8px}

/* Footer */
.footer{position:relative;z-index:1;text-align:center;padding:40px 20px;border-top:1px solid var(--border);color:var(--dim);font-size:.8rem}
.footer a{margin:0 10px}

/* Mobile */
@media(max-width:600px){
  .header{padding:40px 16px 24px}
  .logo{font-size:1.8rem}
  .grid{grid-template-columns:1fr;padding:0 12px 30px}
}
</style>
</head>
<body>

<div class="stars"><canvas id="starCanvas"></canvas></div>

<div class="header">
  <div class="logo"><span class="alien">üëΩ</span> The Ark AI <span>‚ö°</span></div>
  <div class="tagline">Developer tools for sats. Pay per use. No subscription. No signup.</div>
  <div class="hero-stat">
    <span><b>20+</b> dev tools</span>
    <span><b>50</b>‚Äì<b>2,000</b> sats each</span>
    <span>‚ö° Lightning-fast</span>
  </div>
</div>

<div class="filter-bar">
  <button class="filter-btn active" data-cat="all">All Tools</button>
  <button class="filter-btn" data-cat="code">üíª Code</button>
  <button class="filter-btn" data-cat="devops">üîß DevOps</button>
  <button class="filter-btn" data-cat="data">üìä Data</button>
  <button class="filter-btn" data-cat="content">‚úçÔ∏è Content</button>
</div>

<div class="grid" id="grid"></div>

<div class="footer">
  <a href="https://thenode.it.com">üè† Main Site</a>
  <a href="https://thenode.it.com/deploy">üöÄ Deploy</a>
  <a href="https://thenode.it.com/devtools">üõ† DevTools</a>
  <p style="margin-top:12px">The Ark AI ‚Äî Powered by Bitcoin Lightning ‚ö°</p>
</div>

<script>
// Stars
const c=document.getElementById('starCanvas'),ctx=c.getContext('2d');
function resizeCanvas(){c.width=window.innerWidth;c.height=window.innerHeight}
resizeCanvas();window.addEventListener('resize',resizeCanvas);
const stars=Array.from({length:200},()=>({x:Math.random()*c.width,y:Math.random()*c.height,r:Math.random()*1.2+.3,a:Math.random()}));
function drawStars(){ctx.clearRect(0,0,c.width,c.height);stars.forEach(s=>{s.a+=.005+Math.random()*.005;ctx.fillStyle=`rgba(255,255,255,${(.3+Math.sin(s.a)*.3).toFixed(2)})`;ctx.beginPath();ctx.arc(s.x,s.y,s.r,0,Math.PI*2);ctx.fill()});requestAnimationFrame(drawStars)}
drawStars();

// Services
const services=[
  {cat:'code',name:'Code Review',desc:'Paste code, get a detailed review with suggestions.',price:500,placeholder:'Paste your code here...'},
  {cat:'code',name:'Bug Finder',desc:'Find bugs, edge cases, and potential issues in code.',price:500,placeholder:'Paste code to analyze...'},
  {cat:'code',name:'Code Explainer',desc:'Explain what a piece of code does in plain English.',price:200,placeholder:'Paste code to explain...'},
  {cat:'code',name:'Regex Generator',desc:'Describe a pattern, get a working regex.',price:100,placeholder:'e.g. Match email addresses with .com or .org domains'},
  {cat:'code',name:'SQL Optimizer',desc:'Paste a query, get an optimized version.',price:300,placeholder:'Paste your SQL query...'},
  {cat:'code',name:'Documentation Generator',desc:'Generate docs from source code.',price:1000,placeholder:'Paste code to document...'},
  {cat:'code',name:'Git Commit Message',desc:'Generate a commit message from a diff.',price:50,placeholder:'Paste your git diff...'},
  {cat:'code',name:'Unit Test Generator',desc:'Generate unit tests for your code.',price:500,placeholder:'Paste code to generate tests for...'},
  {cat:'devops',name:'Dockerfile Generator',desc:'Describe your app, get a production Dockerfile.',price:300,placeholder:'e.g. Node.js Express app with PostgreSQL'},
  {cat:'devops',name:'CI/CD Config',desc:'Generate GitHub Actions or GitLab CI config.',price:500,placeholder:'e.g. Node.js app, run tests, deploy to Docker Hub'},
  {cat:'devops',name:'Nginx Config',desc:'Describe routing, get an nginx config.',price:200,placeholder:'e.g. Reverse proxy port 3000, SSL, rate limiting'},
  {cat:'devops',name:'Docker Compose',desc:'Describe your stack, get a compose file.',price:500,placeholder:'e.g. FastAPI + Redis + PostgreSQL + Nginx'},
  {cat:'data',name:'JSON/CSV Converter',desc:'Convert between JSON and CSV formats.',price:100,placeholder:'Paste JSON or CSV data...'},
  {cat:'data',name:'Data Cleaner',desc:'Clean messy data ‚Äî fix formatting, remove duplicates.',price:300,placeholder:'Paste messy data...'},
  {cat:'data',name:'API Response Parser',desc:'Extract specific fields from an API response.',price:200,placeholder:'Paste API response and describe what to extract...'},
  {cat:'data',name:'Cron Expression',desc:'Describe a schedule, get a cron expression.',price:50,placeholder:'e.g. Every weekday at 9am UTC'},
  {cat:'content',name:'README Generator',desc:'Describe your project, get a polished README.',price:500,placeholder:'Describe your project (name, purpose, stack, features)...'},
  {cat:'content',name:'API Documentation',desc:'Describe endpoints, get full API docs.',price:1000,placeholder:'Describe your API endpoints...'},
  {cat:'content',name:'Technical Blog Post',desc:'Give a topic, get a full technical blog post.',price:2000,placeholder:'e.g. How to build a Lightning-enabled REST API with Node.js'},
  {cat:'content',name:'Changelog Generator',desc:'Paste commits, get a formatted changelog.',price:300,placeholder:'Paste git log or commit messages...'}
];

const catIcons={code:'üíª',devops:'üîß',data:'üìä',content:'‚úçÔ∏è'};
const grid=document.getElementById('grid');

function renderCards(filter='all'){
  grid.innerHTML='';
  services.filter(s=>filter==='all'||s.cat===filter).forEach((s,i)=>{
    const card=document.createElement('div');
    card.className='card';
    card.dataset.cat=s.cat;
    card.innerHTML=`
      <div class="card-head"><div class="card-title">${catIcons[s.cat]} ${s.name}</div><div class="card-price">‚ö° ${s.price.toLocaleString()} sats</div></div>
      <div class="card-desc">${s.desc}</div>
      <div class="card-expand"><div class="card-inner">
        <textarea placeholder="${s.placeholder}" rows="4"></textarea>
        <button class="submit-btn" onclick="submitTask(this,'${s.name}',${s.price})">‚ö° Try It ‚Äî ${s.price.toLocaleString()} sats</button>
        <div class="card-result"></div>
      </div></div>`;
    card.querySelector('.card-head').addEventListener('click',()=>{
      card.classList.toggle('open');
    });
    card.querySelector('textarea').addEventListener('click',e=>e.stopPropagation());
    grid.appendChild(card);
  });
}
renderCards();

// Filters
document.querySelectorAll('.filter-btn').forEach(b=>{
  b.addEventListener('click',()=>{
    document.querySelectorAll('.filter-btn').forEach(x=>x.classList.remove('active'));
    b.classList.add('active');
    renderCards(b.dataset.cat);
  });
});

// Submit
async function submitTask(btn,name,price){
  const card=btn.closest('.card');
  const input=card.querySelector('textarea').value.trim();
  if(!input){card.querySelector('textarea').focus();return}
  const result=card.querySelector('.card-result');
  btn.disabled=true;btn.textContent='Submitting...';
  result.innerHTML='';

  try{
    const res=await fetch('/task',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({service:name,input})});
    const data=await res.json();
    if(data.payment_request){
      const qrUrl=`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(data.payment_request)}`;
      result.innerHTML=`
        <p>‚ö° Pay <b>${price.toLocaleString()} sats</b> to continue</p>
        <img src="${qrUrl}" alt="Lightning Invoice QR">
        <div class="invoice-text" title="Click to copy" onclick="navigator.clipboard.writeText('${data.payment_request}');this.textContent='Copied!'">${data.payment_request.slice(0,40)}...tap to copy</div>`;
      if(data.task_id) pollResult(data.task_id,result);
    } else if(data.result){
      result.innerHTML=`<pre>${esc(data.result)}</pre>`;
    } else if(data.error){
      result.innerHTML=`<p style="color:#ff5252">${esc(data.error)}</p>`;
    }
  }catch(e){
    result.innerHTML=`<p style="color:#ff5252">Connection error. Is the server running?</p>`;
  }
  btn.disabled=false;btn.textContent=`‚ö° Try It ‚Äî ${price.toLocaleString()} sats`;
}

function esc(s){return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')}

async function pollResult(taskId,el){
  for(let i=0;i<60;i++){
    await new Promise(r=>setTimeout(r,3000));
    try{
      const res=await fetch(`/task/${taskId}`);
      const data=await res.json();
      if(data.status==='completed'&&data.result){
        el.innerHTML=`<div class="pay-status">‚úÖ Paid</div><pre>${esc(data.result)}</pre>`;return;
      }
      if(data.status==='failed'){el.innerHTML+=`<p style="color:#ff5252">Task failed.</p>`;return;}
    }catch(e){}
  }
}
</script>
</body>
</html>
